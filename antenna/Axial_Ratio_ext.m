function result = Axial_Ratio_ext(file_pol_0,file_pol_90,d,type,plots)

% ========================================================================
%
% This script calculates the axial ratio and gain pattern in broadside 
% direction of the antenna
%
%
% Freek Boeykens
% Date: 05/05/2010
% Last modified: 05/05/2010
% ========================================================================



%--------------------------------------------------------------------------
%                           TO ADAPT BY USER

% files 
% current_antenna={'D:\matlab\iridium_final_extra\max_1_S_112_17_0deg_170112.cti','D:\matlab\iridium_final_extra\max_1_S_112_17_90deg_170112.cti'};
% current_antenna={'D:\matlab\iridium_final_extra\max_1_onbody_S_112_17_0deg_180112.cti','D:\matlab\iridium_final_extra\max_1_onbody_S_112_17_90deg_180112.cti'};
% current_antenna={'D:\matlab\iridium_final_extra\max_2_S_112_17_0deg_180112.cti','D:\matlab\iridium_final_extra\max_2_S_112_17_90deg_180112.cti'};
% current_antenna={'D:\matlab\iridium_final_extra\max_2_onbody_S_112_17_0deg_180112.cti','D:\matlab\iridium_final_extra\max_2_onbody_S_112_17_90deg_180112.cti'};
% current_antenna={'D:\matlab\iridium_final_extra\pas_1_S_112_17_0deg_170112.cti','D:\matlab\iridium_final_extra\pas_1_S_112_17_90deg_170112.cti'};
% current_antenna={'D:\matlab\iridium_final_extra\pas_1_S_112_17_0deg_180112.cti','D:\matlab\iridium_final_extra\pas_1_S_112_17_90deg_180112.cti'};
% current_antenna={'D:\matlab\iridium_final_extra\pas_1_onbody_S_112_17_0deg_180112.cti','D:\matlab\iridium_final_extra\pas_1_onbody_S_112_17_90deg_180112.cti'};
% current_antenna={'D:\matlab\iridium_final_extra\pas_2_S_112_17_0deg_180112.cti','D:\matlab\iridium_final_extra\pas_2_S_112_17_90deg_180112.cti'};
% current_antenna={'D:\matlab\iridium_final_extra\pas_2_onbody_S_112_17_0deg_180112.cti','D:\matlab\iridium_final_extra\pas_2_onbody_S_112_17_90deg_180112.cti'};

% file_pol_0  = current_antenna{1};
% file_pol_90 = current_antenna{2};

% distance between horn and antenna [m]
% d = 4.2;

% type horn: 1.1, 1.7, 2.6, 3.9, 5.8, 8.2, 12.4

%--------------------------------------------------------------------------





% parse the files
[freq, S11_pol_0, S21_pol_0, S12_pol_0, S22_pol_0]  = PNAX_parser(file_pol_0);
[freq2,S11_pol_90,S21_pol_90,S12_pol_90,S22_pol_90] = PNAX_parser(file_pol_90);


% get the gain pattern of the horn
switch type
    case 1.1
        freq_horn = 1.1:0.01:1.7;
        gain_horn = [14.36 14.43 14.49 14.55 14.62 14.67 14.73 14.79  ...
                     14.85 14.9 14.96 15.01 15.06 15.11 15.17 15.22   ...
                     15.27 15.32 15.37 15.41 15.46 15.51 15.56 15.60  ...
                     15.65 15.7 15.74 15.79 15.84 15.88 15.93 15.97   ...
                     16.02 16.06 16.11 16.15 16.2 16.24 16.28 16.33   ...
                     16.37 16.41 16.45 16.49 16.53 16.57 16.61 16.65  ...
                     16.69 16.72 16.76 16.8 16.83 16.86 16.89 16.92   ...
                     16.95 16.98 17.00 17.03 17.05];
    case 1.7
        freq_horn = 1.7:0.01:2.6;
        gain_horn = [14.48 14.53 14.58 14.62 14.67 14.71 14.75 14.8   ...
                     14.84 14.88 14.92 14.96 15 15.03 15.07 15.11     ...
                     15.14 15.18 15.22 15.25 15.29 15.32 15.39 15.38  ...
                     15.42 15.45 15.49 15.52 15.55 15.58 15.62 15.65  ...
                     15.68 15.71 15.74 15.77 15.8 15.83 15.89 15.89   ...
                     15.92 15.95 15.98 16.01 16.04 16.07 16.1 16.13   ...
                     16.15 16.18 16.21 16.24 16.27 16.3 16.33 16.36   ...
                     16.39 16.42 16.44 16.47 16.5 16.53 16.56 16.59   ...
                     16.61 16.64 16.68 16.7 16.73 16.75 16.78 16.81   ...
                     16.83 16.86 16.89 16.91 16.94 16.96 16.99 17.01  ...
                     17.04 17.06 17.09 17.11 17.13 17.16 17.18 17.2   ...
                     17.22 17.24 17.26];
    case 2.6
        freq_horn = 2.6:0.01:4;
        gain_horn = [17 17.03 17.07 17.1 17.13 17.15 17.18 17.21 17.24 ...
                     17.27 17.3 17.32 17.35 17.38 17.41 17.43 17.46    ...
                     17.48 17.51 17.54 17.56 17.59 17.61 17.64 17.66   ...
                     17.68 17.71 17.73 17.76 17.78 17.8 17.83 17.85    ...
                     17.87 17.89 17.92 17.94 17.96 17.98 18.01 18.03   ...
                     18.05 18.07 18.09 18.11 18.13 18.15 18.17 18.2    ...
                     18.22 18.24 18.26 18.28 18.3 18.32 18.34 18.36    ...
                     18.38 18.40 18.42 18.43 18.45 18.47 18.49 18.51   ...
                     18.53 18.55 18.57 18.59 18.61 18.62 18.64 18.66   ...
                     18.68 18.70 18.72 18.74 18.75 18.77 18.79 18.81   ...
                     18.83 18.84 18.86 18.88 18.90 18.91 18.93 18.95   ...
                     18.97 18.98 19.00 19.02 19.03 19.05 19.07 19.08   ...
                     19.10 19.12 19.13 19.15 19.17 19.18 19.20 19.22   ...
                     19.23 19.25 19.26 19.28 19.3 19.31 19.33 19.34    ...
                     19.36 19.37 19.39 19.40 19.42 19.43 19.45 19.46   ...
                     19.47 19.49 19.50 19.52 19.53 19.54 19.56 19.57   ...
                     19.59 19.60 19.61 19.62 19.63 19.64 19.66 19.67   ...
                     19.68 19.69 19.70 19.71];
    case 3.9
        freq_horn = 3.94:0.02:5.86;
        gain_horn = [17.08 17.12 17.16 17.20 17.23 17.27 17.31 17.35   ...
                     17.39 17.42 17.46 17.50 17.53 17.57 17.60 17.64   ...
                     17.67 17.71 17.74 17.77 17.81 17.84 17.87 17.90   ...
                     17.94 17.97 18.00 18.03 18.06 18.09 18.12 18.15   ...
                     18.18 18.21 18.24 18.26 18.29 18.32 18.35 18.37   ...
                     18.61 18.63 18.65 18.68 18.70 18.73 18.75 18.77   ...
                     18.79 18.82 18.84 18.86 18.88 18.90 18.93 18.95   ...
                     18.97 18.99 19.01 19.03 19.05 19.07 19.09 19.11   ...
                     19.13 19.15 19.17 19.19 19.20 19.22 19.24 19.26   ...
                     19.28 19.29 19.31 19.33 19.35 19.36 19.38 19.40   ...
                     19.41 19.43 19.44 19.46 19.48 19.49 19.51 19.52   ...
                     19.54];
    case 5.8
        freq_horn = 5.8:0.02:8.2;
        gain_horn = [21.66 21.68 21.69 21.71 21.72 21.74 21.76 21.77   ...
                     21.79 21.80 21.82 21.83 21.85 21.86 21.88 21.89   ...
                     21.91 21.92 21.94 21.96 21.97 21.98 21.99 22.01   ...
                     22.02 22.03 22.04 22.07 22.08 22.09 22.11 22.12   ...
                     22.13 22.15 22.16 22.17 22.19 22.20 22.21 22.22   ...
                     22.24 22.25 22.26 22.27 22.29 22.30 22.31 22.32   ...
                     22.33 22.35 22.36 22.37 22.38 22.39 22.40 22.41   ...
                     22.42 22.43 22.44 22.45 22.46 22.47 22.48 22.49   ...
                     22.50 22.51 22.52 22.53 22.54 22.55 22.56 22.57   ...
                     22.58 22.58 22.59 22.60 22.61 22.62 22.63 22.63   ...
                     22.64 22.65 22.65 22.66 22.67 22.67 22.68 22.69   ...
                     22.69 22.70 22.70 22.71 22.72 22.72 22.73 22.73   ...
                     22.74 22.74 22.75 22.75 22.75 22.76 22.76 22.77   ...
                     22.77 22.77 22.78 22.78 22.78 22.79 22.79 22.79   ...
                     22.79 22.79 22.80 22.80 22.80 22.80 22.80 22.80   ...
                     22.81];
    case 8.2
        freq_horn = 8.2:0.05:12.5;
        gain_horn = [21.37 21.41 21.45 21.49 21.53 21.57 21.60 21.64   ...
                     21.67 21.70 21.73 21.77 21.80 21.82 21.85 21.88   ...
                     21.91 21.93 21.96 21.98 22.01 22.03 22.05 22.07   ...
                     22.09 22.11 22.13 22.15 22.17 22.19 22.21 22.23   ...
                     22.24 22.26 22.28 22.29 22.31 22.33 22.34 22.36   ...
                     22.37 22.39 22.40 22.42 22.43 22.45 22.46 22.47   ...
                     22.49 22.50 22.51 22.53 22.54 22.55 22.57 22.58   ...
                     22.60 22.61 22.62 22.63 22.64 22.65 22.66 22.67   ...
                     22.68 22.69 22.70 22.72 22.73 22.74 22.75 22.76   ...
                     22.77 22.78 22.79 22.79 22.80 22.81 22.82 22.82   ...
                     22.83 22.83 22.84 22.84 22.85 22.85 22.85];
    case 12.4
        freq_horn = 12.4:0.1:18;
        gain_horn = [23.48 23.52 23.57 23.61 23.66 23.70 23.74 23.79   ...
                     23.83 23.87 23.91 23.95 23.99 24.02 24.06 24.10   ...
                     24.13 24.17 24.20 24.24 24.27 24.30 24.34 24.37   ...
                     24.40 24.43 24.46 24.49 24.51 24.54 24.57 24.59   ...
                     24.62 24.64 24.67 24.69 24.71 24.73 24.76 24.78   ...
                     24.79 24.81 24.83 24.85 24.87 24.88 24.90 24.91   ...
                     24.92 24.94 24.95 24.96 24.97 24.98 24.99 24.99   ...
                     25.00];
    case 'uwb'
        freq_horn = [1.1200 1.1215 1.1229 1.1243 1.1258 1.1273 1.1287 1.1301 1.1316 1.1331 1.1345 1.1360 1.1374 1.1389 1.1403 1.1418 1.1432 1.1447 1.1461 1.1476 1.1490 1.1504 1.1519 1.1534 1.1548 1.1562 1.1577 1.1592 1.1606 1.1621 1.1635 1.1650 1.1664 1.1679 1.1693 1.1708 1.1722 1.1737 1.1751 1.1765 1.1780 1.1795 1.1809 1.1824 1.1838 1.1853 1.1867 1.1882 1.1896 1.1911 1.1925 1.1940 1.1954 1.1968 1.1983 1.1998 1.2012 1.2026 1.2041 1.2056 1.2070 1.2085 1.2099 1.2114 1.2128 1.2143 1.2157 1.2172 1.2186 1.2201 1.2215 1.2229 1.2244 1.2259 1.2273 1.2288 1.2302 1.2317 1.2331 1.2346 1.2360 1.2375 1.2389 1.2404 1.2418 1.2433 1.2447 1.2462 1.2476 1.2490 1.2505 1.2520 1.2534 1.2549 1.2563 1.2578 1.2592 1.2607 1.2621 1.2636 1.2650 1.2665 1.2679 1.2693 1.2708 1.2723 1.2737 1.2752 1.2766 1.2781 1.2795 1.2810 1.2824 1.2839 1.2853 1.2868 1.2882 1.2897 1.2911 1.2926 1.2940 1.2954 1.2969 1.2984 1.2998 1.3013 1.3027 1.3042 1.3056 1.3071 1.3085 1.3100 1.3114 1.3129 1.3143 1.3157 1.3172 1.3187 1.3201 1.3216 1.3230 1.3245 1.3259 1.3274 1.3288 1.3303 1.3317 1.3332 1.3346 1.3361 1.3375 1.3390 1.3404 1.3418 1.3433 1.3448 1.3462 1.3477 1.3491 1.3506 1.3520 1.3535 1.3549 1.3564 1.3578 1.3593 1.3607 1.3622 1.3636 1.3651 1.3665 1.3679 1.3694 1.3709 1.3723 1.3738 1.3752 1.3767 1.3781 1.3796 1.3810 1.3825 1.3839 1.3854 1.3868 1.3882 1.3897 1.3912 1.3926 1.3941 1.3955 1.3970 1.3984 1.3999 1.4013 1.4028 1.4042 1.4057 1.4071 1.4086 1.4100 1.4115 1.4129 1.4143 1.4158 1.4173 1.4187 1.4202 1.4216 1.4231 1.4245 1.4260 1.4274 1.4289 1.4303 1.4318 1.4332 1.4346 1.4361 1.4376 1.4390 1.4405 1.4419 1.4434 1.4448 1.4463 1.4477 1.4492 1.4506 1.4521 1.4535 1.4550 1.4564 1.4579 1.4593 1.4607 1.4622 1.4637 1.4651 1.4666 1.4680 1.4695 1.4709 1.4724 1.4738 1.4753 1.4767 1.4782 1.4796 1.4811 1.4825 1.4840 1.4854 1.4869 1.4883 1.4898 1.4912 1.4927 1.4941 1.4956 1.4970 1.4985 1.4999 1.5014 1.5028 1.5043 1.5057 1.5071 1.5086 1.5101 1.5115 1.5130 1.5144 1.5159 1.5173 1.5188 1.5202 1.5217 1.5231 1.5246 1.5260 1.5275 1.5289 1.5304 1.5318 1.5333 1.5347 1.5362 1.5376 1.5391 1.5405 1.5420 1.5434 1.5449 1.5463 1.5478 1.5492 1.5507 1.5521 1.5535 1.5550 1.5565 1.5579 1.5594 1.5608 1.5623 1.5637 1.5652 1.5666 1.5681 1.5695 1.5710 1.5724 1.5739 1.5753 1.5768 1.5782 1.5796 1.5811 1.5826 1.5840 1.5855 1.5869 1.5884 1.5898 1.5913 1.5927 1.5942 1.5956 1.5971 1.5985 1.6000 1.6014  1.6029 1.6043 1.6058 1.6072 1.6087 1.6101 1.6116 1.6130 1.6145 1.6159 1.6174 1.6188 1.6203 1.6217 1.6232 1.6246 1.6260 1.6275 1.6290 1.6304 1.6319 1.6333 1.6348 1.6362 1.6377 1.6391 1.6406 1.6420 1.6435 1.6449 1.6464 1.6478 1.6493 1.6507 1.6522 1.6536 1.6551 1.6565 1.6580 1.6594 1.6609 1.6623 1.6638 1.6652 1.6667 1.6681 1.6696 1.6710 1.6725 1.6739 1.6754 1.6768 1.6783 1.6797 1.6812 1.6826 1.6841 1.6855 1.6870 1.6884 1.6899 1.6913 1.6928 1.6942 1.6957 1.6971 1.6986 1.7000 1.7023 1.7045 1.7068 1.7090 1.7113 1.7135 1.7158 1.7180 1.7203 1.7225 1.7248 1.7270 1.7293 1.7315 1.7338 1.7360 1.7383 1.7405 1.7428 1.7450 1.7473 1.7495 1.7518 1.7540 1.7563 1.7585 1.7608 1.7630 1.7653 1.7675 1.7698 1.7720 1.7743 1.7765 1.7788 1.7810 1.7833 1.7855 1.7878 1.7900 1.7923 1.7945 1.7968 1.7990 1.8013 1.8035 1.8058 1.8080 1.8103 1.8125 1.8148 1.8170 1.8193 1.8215 1.8238 1.8260 1.8283 1.8305 1.8328 1.8350 1.8373 1.8395 1.8418 1.8440 1.8463 1.8485 1.8508 1.8530 1.8553 1.8575 1.8598 1.8620 1.8643 1.8665 1.8688 1.8710 1.8733 1.8755 1.8778 1.8800 1.8823 1.8845 1.8868 1.8890 1.8913 1.8935 1.8958 1.8980 1.9003 1.9025 1.9048 1.9070 1.9093 1.9115 1.9138 1.9160 1.9183 1.9205 1.9228 1.9250 1.9273 1.9295 1.9318 1.9340 1.9363 1.9385 1.9408 1.9430 1.9453 1.9475 1.9498 1.9520 1.9543 1.9565 1.9588 1.9610 1.9633 1.9655 1.9678 1.9700 1.9723 1.9745 1.9768 1.9790 1.9813 1.9835 1.9858 1.9880 1.9903 1.9925 1.9948 1.9970 1.9993 2.0015 2.0038 2.0060 2.0083 2.0105 2.0128 2.0150 2.0173 2.0195 2.0217 2.0240 2.0263 2.0285 2.0308 2.0330 2.0353 2.0375 2.0398 2.0420 2.0443 2.0465 2.0488 2.0510 2.0533 2.0555 2.0577 2.0600 2.0623 2.0645 2.0668 2.0690 2.0713 2.0735 2.0758 2.0780 2.0802 2.0825 2.0848 2.0870 2.0893 2.0915 2.0938 2.0960 2.0983 2.1005 2.1028 2.1050 2.1073 2.1095 2.1118 2.1140 2.1162 2.1185 2.1208 2.1230 2.1253 2.1275 2.1298 2.1320 2.1343 2.1365 2.1387 2.1410 2.1433 2.1455 2.1478 2.1500 2.1522 2.1545 2.1568 2.1590 2.1613 2.1635 2.1658 2.1680 2.1703 2.1725 2.1747 2.1770 2.1793 2.1815 2.1838 2.1860 2.1883 2.1905 2.1928 2.1950 2.1972 2.1995 2.2018 2.2040 2.2063 2.2085 2.2107 2.2130 2.2153 2.2175 2.2198 2.2220 2.2243 2.2265 2.2288 2.2310 2.2332 2.2355 2.2378 2.2400 2.2423 2.2445 2.2468 2.2490 2.2513 2.2535 2.2557 2.2580 2.2603 2.2625 2.2648 2.2670 2.2692 2.2715 2.2738 2.2760 2.2783 2.2805 2.2828 2.2850 2.2873 2.2895 2.2917 2.2940 2.2963 2.2985 2.3008 2.3030 2.3053 2.3075 2.3098 2.3120 2.3143 2.3165 2.3188 2.3210 2.3233 2.3255 2.3277 2.3300 2.3323 2.3345 2.3368 2.3390 2.3413 2.3435 2.3458 2.3480 2.3502 2.3525 2.3548 2.3570 2.3593 2.3615 2.3638 2.3660 2.3683 2.3705 2.3728 2.3750 2.3773 2.3795 2.3818 2.3840 2.3862 2.3885 2.3908 2.3930 2.3953 2.3975 2.3998 2.4020 2.4043 2.4065 2.4087 2.4110 2.4133 2.4155 2.4178 2.4200 2.4223 2.4245 2.4268 2.4290 2.4313 2.4335 2.4358 2.4380 2.4403 2.4425 2.4447 2.4470 2.4493 2.4515 2.4538 2.4560 2.4583 2.4605 2.4628 2.4650 2.4672 2.4695 2.4718 2.4740 2.4763 2.4785 2.4808 2.4830 2.4853 2.4875 2.4898 2.4920 2.4943 2.4965 2.4988 2.5010 2.5032 2.5055 2.5078 2.5100 2.5123 2.5145 2.5168 2.5190 2.5213 2.5235 2.5257 2.5280 2.5303 2.5325 2.5348 2.5370 2.5393 2.5415 2.5438 2.5460 2.5483 2.5505 2.5528 2.5550 2.5573 2.5595 2.5617 2.5640 2.5663 2.5685 2.5708 2.5730 2.5753 2.5775 2.5798 2.5820 2.5843 2.5865 2.5888 2.5910 2.5933 2.5955 2.5978 2.6000 2.6034 2.6068 2.6101 2.6135 2.6169 2.6202 2.6236 2.6270 2.6304 2.6338 2.6371 2.6405 2.6439 2.6473 2.6506 2.6540 2.6574 2.6608 2.6641 2.6675 2.6709 2.6743 2.6776 2.6810 2.6844 2.6878 2.6911 2.6945 2.6979 2.7013 2.7046 2.7080 2.7114 2.7147 2.7181 2.7215 2.7249 2.7283 2.7316 2.7350 2.7384 2.7418 2.7451 2.7485 2.7519 2.7553 2.7586 2.7620 2.7654 2.7688 2.7721 2.7755 2.7789 2.7823 2.7856 2.7890 2.7924 2.7957 2.7991 2.8025 2.8059 2.8093 2.8126 2.8160 2.8194 2.8228 2.8261 2.8295 2.8329 2.8363 2.8396 2.8430 2.8464 2.8498 2.8531 2.8565 2.8599 2.8633 2.8666 2.8700 2.8734 2.8768 2.8801 2.8835 2.8869 2.8902 2.8936 2.8970 2.9004 2.9038 2.9071 2.9105 2.9139 2.9173 2.9206 2.9240 2.9274 2.9308 2.9341 2.9375 2.9409 2.9443 2.9476 2.9510 2.9544 2.9578 2.9611 2.9645 2.9679 2.9713 2.9746 2.9780 2.9814 2.9848 2.9881 2.9915 2.9949 2.9983 3.0016 3.0050 3.0084 3.0118 3.0151 3.0185 3.0219 3.0253 3.0286 3.0320 3.0354 3.0388 3.0421 3.0455 3.0489 3.0523 3.0556 3.0590 3.0624 3.0657 3.0691 3.0725 3.0759 3.0793 3.0826 3.0860 3.0894 3.0928 3.0961 3.0995 3.1029 3.1063 3.1096 3.1130 3.1164 3.1198 3.1231 3.1265 3.1299 3.1333 3.1366 3.1400 3.1434 3.1468 3.1501 3.1535 3.1569 3.1603 3.1636 3.1670 3.1704 3.1738 3.1771 3.1805 3.1839 3.1873 3.1906 3.1940 3.1974 3.2008 3.2041 3.2075 3.2109 3.2143 3.2176 3.2210 3.2244 3.2278 3.2311 3.2345 3.2379 3.2413 3.2446 3.2480 3.2514 3.2548 3.2581 3.2615 3.2649 3.2683 3.2716 3.2750 3.2784 3.2818 3.2851 3.2885 3.2919 3.2953 3.2986 3.3020 3.3054 3.3088 3.3121 3.3155 3.3189 3.3223 3.3256 3.3290 3.3324 3.3357 3.3391 3.3425 3.3459 3.3493 3.3526 3.3560 3.3594 3.3628 3.3661 3.3695 3.3729 3.3763 3.3796 3.3830 3.3864 3.3898 3.3931 3.3965 3.3999 3.4033 3.4066 3.4100 3.4134 3.4168 3.4201 3.4235 3.4269 3.4303 3.4336 3.4370 3.4404 3.4438 3.4471 3.4505 3.4539 3.4573 3.4606 3.4640 3.4674 3.4708 3.4741 3.4775 3.4809 3.4843 3.4876 3.4910 3.4944 3.4978 3.5011 3.5045 3.5079 3.5113 3.5146 3.5180 3.5214 3.5248 3.5281 3.5315 3.5349 3.5383 3.5416 3.5450 3.5484 3.5518 3.5551 3.5585 3.5619 3.5653 3.5686 3.5720 3.5754 3.5788 3.5821 3.5855 3.5889 3.5923 3.5956 3.5990 3.6024 3.6058 3.6091 3.6125 3.6159 3.6193 3.6226 3.6260 3.6294 3.6328 3.6361 3.6395 3.6429 3.6463 3.6496 3.6530 3.6564 3.6598 3.6631 3.6665 3.6699 3.6733 3.6766 3.6800 3.6834 3.6868 3.6901 3.6935 3.6969 3.7003 3.7036 3.7070 3.7104 3.7138 3.7171 3.7205 3.7239 3.7273 3.7306 3.7340 3.7374 3.7408 3.7441 3.7475 3.7509 3.7543 3.7576 3.7610 3.7644 3.7678 3.7711 3.7745 3.7779 3.7813 3.7846 3.7880 3.7914 3.7948 3.7981 3.8015 3.8049 3.8083 3.8116 3.8150 3.8184 3.8218 3.8251 3.8285 3.8319 3.8353 3.8386 3.8420 3.8454 3.8488 3.8521 3.8555 3.8589 3.8623 3.8656 3.8690 3.8724 3.8758 3.8791 3.8825 3.8859 3.8893 3.8926 3.8960 3.8994 3.9028 3.9061 3.9095 3.9129 3.9163 3.9196 3.9230 3.9264 3.9298 3.9331 3.9365 3.9399 3.9433 3.9466 3.9500 3.9548 3.9595 3.9643 3.9690 3.9738 3.9785 3.9833 3.9880 3.9928 3.9975 4.0023 4.0070 4.0118 4.0165 4.0213 4.0260 4.0308 4.0355 4.0403 4.0450 4.0498 4.0545 4.0593 4.0640 4.0688 4.0735 4.0783 4.0830 4.0878 4.0925 4.0972 4.1020 4.1067 4.1115 4.1162 4.1210 4.1258 4.1305 4.1353 4.1400 4.1448 4.1495 4.1543 4.1590 4.1638 4.1685 4.1733 4.1780 4.1828 4.1875 4.1923 4.1970 4.2018 4.2065 4.2113 4.2160 4.2208 4.2255 4.2302 4.2350 4.2397 4.2445 4.2492 4.2540 4.2588 4.2635 4.2683 4.2730 4.2778 4.2825 4.2873 4.2920 4.2968 4.3015 4.3063 4.3110 4.3158 4.3205 4.3253 4.3300 4.3348 4.3395 4.3443 4.3490 4.3538 4.3585 4.3632 4.3680 4.3727 4.3775 4.3822 4.3870 4.3918 4.3965 4.4013 4.4060 4.4108 4.4155 4.4203 4.4250 4.4298 4.4345 4.4393 4.4440 4.4488 4.4535 4.4583 4.4630 4.4678 4.4725 4.4773 4.4820 4.4868 4.4915 4.4962 4.5010 4.5057 4.5105 4.5152 4.5200 4.5248 4.5295 4.5343 4.5390 4.5438 4.5485 4.5533 4.5580 4.5628 4.5675 4.5723 4.5770 4.5818 4.5865 4.5913 4.5960 4.6008 4.6055 4.6103 4.6150 4.6198 4.6245 4.6292 4.6340 4.6387 4.6435 4.6482 4.6530 4.6578 4.6625 4.6673 4.6720 4.6768 4.6815 4.6863 4.6910 4.6958 4.7005 4.7053 4.7100 4.7148 4.7195 4.7243 4.7290 4.7338 4.7385 4.7433 4.7480 4.7528 4.7575 4.7622 4.7670 4.7717 4.7765 4.7812 4.7860 4.7908 4.7955 4.8003 4.8050 4.8098 4.8145 4.8193 4.8240 4.8288 4.8335 4.8383 4.8430 4.8478 4.8525 4.8573 4.8620 4.8668 4.8715 4.8763 4.8810 4.8858 4.8905 4.8952 4.9000 4.9047 4.9095 4.9143 4.9190 4.9238 4.9285 4.9333 4.9380 4.9428 4.9475 4.9523 4.9570 4.9618 4.9665 4.9713 4.9760 4.9808 4.9855 4.9903 4.9950 4.9998 5.0045 5.0093 5.0140 5.0188 5.0235 5.0282 5.0330 5.0377 5.0425 5.0473 5.0520 5.0568 5.0615 5.0663 5.0710 5.0758 5.0805 5.0853 5.0900 5.0948 5.0995 5.1043 5.1090 5.1138 5.1185 5.1233 5.1280 5.1328 5.1375 5.1423 5.1470 5.1518 5.1565 5.1612 5.1660 5.1707 5.1755 5.1803 5.1850 5.1898 5.1945 5.1993 5.2040 5.2088 5.2135 5.2183 5.2230 5.2278 5.2325 5.2373 5.2420 5.2468 5.2515 5.2563 5.2610 5.2658 5.2705 5.2753 5.2800 5.2848 5.2895 5.2942 5.2990 5.3037 5.3085 5.3133 5.3180 5.3228 5.3275 5.3323 5.3370 5.3418 5.3465 5.3513 5.3560 5.3608 5.3655 5.3703 5.3750 5.3798 5.3845 5.3893 5.3940 5.3988 5.4035 5.4083 5.4130 5.4178 5.4225 5.4272 5.4320 5.4367 5.4415 5.4463 5.4510 5.4558 5.4605 5.4653 5.4700 5.4748 5.4795 5.4843 5.4890 5.4938 5.4985 5.5033 5.5080 5.5128 5.5175 5.5223 5.5270 5.5318 5.5365 5.5413 5.5460 5.5508 5.5555 5.5602 5.5650 5.5697 5.5745 5.5793 5.5840 5.5888 5.5935 5.5983 5.6030 5.6078 5.6125 5.6173 5.6220 5.6268 5.6315 5.6363 5.6410 5.6458 5.6505 5.6553 5.6600 5.6648 5.6695 5.6743 5.6790 5.6838 5.6885 5.6932 5.6980 5.7027 5.7075 5.7123 5.7170 5.7218 5.7265 5.7313 5.7360 5.7408 5.7455 5.7503 5.7550 5.7598 5.7645 5.7693 5.7740 5.7788 5.7835 5.7883 5.7930 5.7978 5.8025 5.8073 5.8120 5.8168 5.8215 5.8262 5.8310 5.8357 5.8405 5.8453 5.8500 5.8559 5.8618 5.8676 5.8735 5.8794 5.8853 5.8911 5.8970 5.9029 5.9088 5.9146 5.9205 5.9264 5.9323 5.9381 5.9440 5.9499 5.9558 5.9616 5.9675 5.9734 5.9793 5.9851 5.9910 5.9969 6.0028 6.0086 6.0145 6.0204 6.0263 6.0321 6.0380 6.0439 6.0498 6.0556 6.0615 6.0674 6.0733 6.0791 6.0850 6.0909 6.0968 6.1026 6.1085 6.1144 6.1203 6.1261 6.1320 6.1379 6.1438 6.1496 6.1555 6.1614 6.1673 6.1731 6.1790 6.1849 6.1908 6.1966 6.2025 6.2084 6.2143 6.2201 6.2260 6.2319 6.2378 6.2436 6.2495 6.2554 6.2613 6.2671 6.2730 6.2789 6.2848 6.2906 6.2965 6.3024 6.3083 6.3141 6.3200 6.3259 6.3318 6.3376 6.3435 6.3494 6.3553 6.3611 6.3670 6.3729 6.3788 6.3846 6.3905 6.3964 6.4023 6.4081 6.4140 6.4199 6.4258 6.4316 6.4375 6.4434 6.4493 6.4551 6.4610 6.4669 6.4728 6.4786 6.4845 6.4904 6.4963 6.5021 6.5080 6.5139 6.5198 6.5256 6.5315 6.5374 6.5433 6.5491 6.5550 6.5609 6.5668 6.5726 6.5785 6.5844 6.5903 6.5961 6.6020 6.6079 6.6138 6.6196 6.6255 6.6314 6.6373 6.6431 6.6490 6.6549 6.6608 6.6666 6.6725 6.6784 6.6843 6.6901 6.6960 6.7019 6.7078 6.7136 6.7195 6.7254 6.7313 6.7371 6.7430 6.7489 6.7548 6.7606 6.7665 6.7724 6.7783 6.7841 6.7900 6.7959 6.8018 6.8076 6.8135 6.8194 6.8253 6.8311 6.8370 6.8429 6.8488 6.8546 6.8605 6.8664 6.8723 6.8781 6.8840 6.8899 6.8958 6.9016 6.9075 6.9134 6.9193 6.9251 6.9310 6.9369 6.9428 6.9486 6.9545 6.9604 6.9663 6.9721 6.9780 6.9839 6.9898 6.9956 7.0015 7.0074 7.0133 7.0191 7.0250 7.0309 7.0368 7.0426 7.0485 7.0544 7.0603 7.0661 7.0720 7.0779 7.0838 7.0896 7.0955 7.1014 7.1073 7.1131 7.1190 7.1249 7.1308 7.1366 7.1425 7.1484 7.1543 7.1601 7.1660 7.1719 7.1778 7.1836 7.1895 7.1954 7.2013 7.2071 7.2130 7.2189 7.2248 7.2306 7.2365 7.2424 7.2483 7.2541 7.2600 7.2659 7.2718 7.2776 7.2835 7.2894 7.2953 7.3011 7.3070 7.3129 7.3188 7.3246 7.3305 7.3364 7.3423 7.3481 7.3540 7.3599 7.3658 7.3716 7.3775 7.3834 7.3893 7.3951 7.4010 7.4069 7.4128 7.4186 7.4245 7.4304 7.4363 7.4421 7.4480 7.4539 7.4598 7.4656 7.4715 7.4774 7.4833 7.4891 7.4950 7.5009 7.5068 7.5126 7.5185 7.5244 7.5303 7.5361 7.5420 7.5479 7.5538 7.5596 7.5655 7.5714 7.5773 7.5831 7.5890 7.5949 7.6008 7.6066 7.6125 7.6184 7.6243 7.6301 7.6360 7.6419 7.6478 7.6536 7.6595 7.6654 7.6713 7.6771 7.6830 7.6889 7.6948 7.7006 7.7065 7.7124 7.7183 7.7241 7.7300 7.7359 7.7418 7.7476 7.7535 7.7594 7.7653 7.7711 7.7770 7.7829 7.7888 7.7946 7.8005 7.8064 7.8123 7.8181 7.8240 7.8299 7.8358 7.8416 7.8475 7.8534 7.8593 7.8651 7.8710 7.8769 7.8828 7.8886 7.8945 7.9004 7.9063 7.9121 7.9180 7.9239 7.9298 7.9356 7.9415 7.9474 7.9533 7.9591 7.9650 7.9709 7.9768 7.9826 7.9885 7.9944 8.0003 8.0061 8.0120 8.0179 8.0237 8.0296 8.0355 8.0414 8.0473 8.0531 8.0590 8.0649 8.0708 8.0766 8.0825 8.0884 8.0943 8.1001 8.1060 8.1119 8.1178 8.1236 8.1295 8.1354 8.1413 8.1471 8.1530 8.1589 8.1647 8.1706 8.1765 8.1824 8.1883 8.1941 8.2000 8.2105 8.2210 8.2315 8.2420 8.2525 8.2630 8.2735 8.2840 8.2945 8.3050 8.3155 8.3260 8.3365 8.3470 8.3575 8.3680 8.3785 8.3890 8.3995 8.4100 8.4205 8.4310 8.4415 8.4520 8.4625 8.4730 8.4835 8.4940 8.5045 8.5150 8.5255 8.5360 8.5465 8.5570 8.5675 8.5780 8.5885 8.5990 8.6095 8.6200 8.6305 8.6410 8.6515 8.6620 8.6725 8.6830 8.6935 8.7040 8.7145 8.7250 8.7355 8.7460 8.7565 8.7670 8.7775 8.7880 8.7985 8.8090 8.8195 8.8300 8.8405 8.8510 8.8615 8.8720 8.8825 8.8930 8.9035 8.9140 8.9245 8.9350 8.9455 8.9560 8.9665 8.9770 8.9875 8.9980 9.0085 9.0190 9.0295 9.0400 9.0505 9.0610 9.0715 9.0820 9.0925 9.1030 9.1135 9.1240 9.1345 9.1450 9.1555 9.1660 9.1765 9.1870 9.1975 9.2080 9.2185 9.2290 9.2395 9.2500 9.2605 9.2710 9.2815 9.2920 9.3025 9.3130 9.3235 9.3340 9.3445 9.3550 9.3655 9.3760 9.3865 9.3970 9.4075 9.4180 9.4285 9.4390 9.4495 9.4600 9.4705 9.4810 9.4915 9.5020 9.5125 9.5230 9.5335 9.5440 9.5545 9.5650 9.5755 9.5860 9.5965 9.6070 9.6175 9.6280 9.6385 9.6490 9.6595 9.6700 9.6805 9.6910 9.7015 9.7120 9.7225 9.7330 9.7435 9.7540 9.7645 9.7750 9.7855 9.7960 9.8065 9.8170 9.8275 9.8380 9.8485 9.8590 9.8695 9.8800 9.8905 9.9010 9.9115 9.9220 9.9325 9.9430 9.9535 9.9640 9.9745 9.9850 9.9955 10.0060 10.0165 10.0270 10.0375 10.0480 10.0585 10.0690 10.0795 10.0900 10.1005 10.1110 10.1215 10.1320 10.1425 10.1530 10.1635 10.1740 10.1845 10.1950 10.2055 10.2160 10.2265 10.2370 10.2475 10.2580 10.2685 10.2790 10.2895 10.3000 10.3105 10.3210 10.3315 10.3420 10.3525 10.3630 10.3735 10.3840 10.3945 10.4050 10.4155 10.4260 10.4365 10.4470 10.4575 10.4680 10.4785 10.4890 10.4995 10.5100 10.5205 10.5310 10.5415 10.5520 10.5625 10.5730 10.5835 10.5940 10.6045 10.6150 10.6255 10.6360 10.6465 10.6570 10.6675 10.6780 10.6885 10.6990 10.7095 10.7200 10.7305 10.7410 10.7515 10.7620 10.7725 10.7830 10.7935 10.8040 10.8145 10.8250 10.8355 10.8460 10.8565 10.8670 10.8775 10.8880 10.8985 10.9090 10.9195 10.9300 10.9405 10.9510 10.9615 10.9720 10.9825 10.9930 11.0035 11.0140 11.0245 11.0350 11.0455 11.0560 11.0665 11.0770 11.0875 11.0980 11.1085 11.1190 11.1295 11.1400 11.1505 11.1610 11.1715 11.1820 11.1925 11.2030 11.2135 11.2240 11.2345 11.2450 11.2555 11.2660 11.2765 11.2870 11.2975 11.3080 11.3185 11.3290 11.3395 11.3500 11.3605 11.3710 11.3815 11.3920 11.4025 11.4130 11.4235 11.4340 11.4445 11.4550 11.4655 11.4760 11.4865 11.4970 11.5075 11.5180 11.5285 11.5390 11.5495 11.5600 11.5705 11.5810 11.5915 11.6020 11.6125 11.6230 11.6335 11.6440 11.6545 11.6650 11.6755 11.6860 11.6965 11.7070 11.7175 11.7280 11.7385 11.7490 11.7595 11.7700 11.7805 11.7910 11.8015 11.8120 11.8225 11.8330 11.8435 11.8540 11.8645 11.8750 11.8855 11.8960 11.9065 11.9170 11.9275 11.9380 11.9485 11.9590 11.9695 11.9800 11.9905 12.0010 12.0115 12.0220 12.0325 12.0430 12.0535 12.0640 12.0745 12.0850 12.0955 12.1060 12.1165 12.1270 12.1375 12.1480 12.1585 12.1690 12.1795 12.1900 12.2005 12.2110 12.2215 12.2320 12.2425 12.2530 12.2635 12.2740 12.2845 12.2950 12.3055 12.3160 12.3265 12.3370 12.3475 12.3580 12.3685 12.3790 12.3895 12.4000];
        gain_horn = [6.3029 6.3111 6.3177 6.3171 6.3119 6.2970 6.2768 6.2531 6.2285 6.2092 6.1964 6.1872 6.1867 6.1962 6.2109 6.2326 6.2633 6.2978 6.3292 6.3577 6.3820 6.3927 6.3953 6.4008 6.4089 6.4239 6.4547 6.4979 6.5426 6.5875 6.6323 6.6664 6.6887 6.7087 6.7239 6.7316 6.7415 6.7567 6.7744 6.7978 6.8318 6.8705 6.9084 6.9494 6.9910 7.0245 7.0518 7.0755 7.0883 7.0919 7.0962 7.1008 7.1045 7.1162 7.1382 7.1626 7.1872 7.2140 7.2386 7.2575 7.2771 7.2978 7.3163 7.3387 7.3669 7.3922 7.4098 7.4235 7.4330 7.4368 7.4426 7.4551 7.4688 7.4834 7.5016 7.5208 7.5351 7.5501 7.5671 7.5806 7.5928 7.6079 7.6225 7.6357 7.6519 7.6688 7.6822 7.6936 7.7049 7.7144 7.7233 7.7357 7.7495 7.7592 7.7670 7.7742 7.7786 7.7809 7.7855 7.7894 7.7908 7.7932 7.7984 7.8024 7.8077 7.8169 7.8252 7.8313 7.8385 7.8462 7.8487 7.8473 7.8440 7.8332 7.8163 7.8003 7.7861 7.7723 7.7628 7.7591 7.7550 7.7503 7.7499 7.7474 7.7404 7.7351 7.7322 7.7278 7.7259 7.7289 7.7335 7.7368 7.7425 7.7515 7.7596 7.7686 7.7790 7.7844 7.7823 7.7777 7.7703 7.7600 7.7528 7.7490 7.7467 7.7481 7.7542 7.7620 7.7692 7.7763 7.7813 7.7803 7.7758 7.7706 7.7641 7.7575 7.7564 7.7583 7.7614 7.7680 7.7785 7.7892 7.8011 7.8166 7.8313 7.8426 7.8539 7.8648 7.8730 7.8812 7.8930 7.9062 7.9219 7.9412 7.9616 7.9814 7.9995 8.0149 8.0245 8.0281 8.0269 8.0222 8.0158 8.0087 8.0051 8.0045 8.0062 8.0120 8.0216 8.0318 8.0436 8.0569 8.0689 8.0785 8.0874 8.0925 8.0909 8.0855 8.0774 8.0666 8.0580 8.0553 8.0582 8.0662 8.0822 8.1020 8.1181 8.1297 8.1347 8.1295 8.1158 8.1001 8.0835 8.0670 8.0563 8.0540 8.0560 8.0629 8.0734 8.0824 8.0877 8.0909 8.0886 8.0784 8.0641 8.0462 8.0222 7.9979 7.9816 7.9705 7.9670 7.9775 7.9971 8.0178 8.0393 8.0586 8.0670 8.0642 8.0570 8.0448 8.0280 8.0167 8.0132 8.0140 8.0208 8.0373 8.0533 8.0651 8.0768 8.0831 8.0787 8.0709 8.0621 8.0493 8.0380 8.0339 8.0332 8.0351 8.0471 8.0677 8.0887 8.1110 8.1338 8.1467 8.1494 8.1505 8.1461 8.1339 8.1257 8.1240 8.1233 8.1284 8.1445 8.1656 8.1904 8.2236 8.2583 8.2841 8.3043 8.3208 8.3307 8.3381 8.3534 8.3739 8.3935 8.4169 8.4414 8.4583 8.4710 8.4845 8.4932 8.4982 8.5077 8.5187 8.5246 8.5316 8.5423 8.5515 8.5628 8.5823 8.6068 8.6304 8.6586 8.6860 8.7015 8.7056 8.7025 8.6890 8.6668 8.6475 8.6329 8.6191 8.6093 8.6035 8.5964 8.5874 8.5835 8.5847 8.5885 8.5988 8.6180 8.6377 8.6546 8.6685 8.6739 8.6686 8.6593 8.6491 8.6386 8.6336 8.6356 8.6395 8.6431 8.6457 8.6448 8.6395 8.6330 8.6258 8.6168 8.6079 8.6007 8.5909 8.5762 8.5624 8.5523 8.5472 8.5535 8.5704 8.5908 8.6118 8.6311 8.6418 8.6389 8.6253 8.6032 8.5735 8.5436 8.5205 8.5029 8.4897 8.4832 8.4787 8.4728 8.4698 8.4686 8.4659 8.4638 8.4619 8.4547 8.4396 8.4195 8.3931 8.3608 8.3293 8.3036 8.2830 8.2712 8.2690 8.2681 8.2626 8.2531 8.2362 8.2073 8.1753 8.1463 8.1191 8.0969 8.0831 8.0737 8.0650 8.0603 8.0573 8.0501 8.0420 8.0375 8.0308 8.0204 8.0138 8.0056 7.9974 8.0581 8.1373 8.1616 8.2017 8.2499 8.3143 8.3703 8.4135 8.4375 8.4596 8.4835 8.5193 8.5703 8.6338 8.7077 8.7711 8.8226 8.8481 8.8615 8.8649 8.8752 8.8924 8.9214 8.9574 8.9833 8.9974 8.9910 8.9751 8.9485 8.9313 8.9198 8.9236 8.9329 8.9411 8.9439 8.9332 8.9147 8.8870 8.8659 8.8474 8.8416 8.8353 8.8258 8.8043 8.7719 8.7335 8.6948 8.6707 8.6608 8.6722 8.6914 8.7132 8.7236 8.7206 8.7030 8.6753 8.6493 8.6298 8.6266 8.6361 8.6563 8.6793 8.6981 8.7062 8.7067 8.6992 8.6947 8.6943 8.6999 8.7099 8.7208 8.7295 8.7348 8.7374 8.7354 8.7360 8.7372 8.7437 8.7521 8.7624 8.7696 8.7705 8.7668 8.7602 8.7569 8.7591 8.7699 8.7854 8.8053 8.8248 8.8414 8.8541 8.8616 8.8668 8.8708 8.8784 8.8937 8.9175 8.9474 8.9783 9.0042 9.0230 9.0336 9.0381 9.0413 9.0458 9.0575 9.0727 9.0918 9.1112 9.1268 9.1368 9.1393 9.1392 9.1400 9.1457 9.1558 9.1726 9.1884 9.2026 9.2117 9.2146 9.2143 9.2119 9.2123 9.2136 9.2180 9.2232 9.2257 9.2235 9.2167 9.2067 9.1970 9.1920 9.1926 9.1973 9.2025 9.2051 9.2045 9.2012 9.1981 9.1961 9.1985 9.2039 9.2102 9.2184 9.2235 9.2212 9.2149 9.2064 9.1964 9.1902 9.1875 9.1876 9.1935 9.2021 9.2100 9.2138 9.2135 9.2066 9.1968 9.1848 9.1710 9.1607 9.1545 9.1499 9.1448 9.1450 9.1460 9.1469 9.1495 9.1510 9.1501 9.1496 9.1472 9.1445 9.1403 9.1343 9.1251 9.1143 9.1043 9.0989 9.0978 9.1014 9.1105 9.1196 9.1238 9.1228 9.1170 9.1095 9.1036 9.1032 9.1149 9.1314 9.1512 9.1647 9.1688 9.1613 9.1479 9.1358 9.1340 9.1490 9.1731 9.2050 9.2309 9.2470 9.2500 9.2412 9.2302 9.2251 9.2291 9.2443 9.2688 9.2946 9.3081 9.3079 9.2955 9.2801 9.2686 9.2720 9.2893 9.3141 9.3439 9.3650 9.3772 9.3786 9.3738 9.3673 9.3673 9.3748 9.3891 9.4064 9.4141 9.4171 9.4069 9.3952 9.3830 9.3840 9.3936 9.4121 9.4383 9.4565 9.4724 9.4736 9.4769 9.4713 9.4776 9.4893 9.5070 9.5293 9.5472 9.5611 9.5611 9.5595 9.5520 9.5522 9.5527 9.5637 9.5714 9.5777 9.5807 9.5774 9.5714 9.5661 9.5697 9.5748 9.5940 9.6092 9.6282 9.6421 9.6529 9.6639 9.6711 9.6802 9.6880 9.7003 9.7073 9.7184 9.7202 9.7232 9.7276 9.7331 9.7431 9.7545 9.7686 9.7758 9.7839 9.7850 9.7840 9.7760 9.7635 9.7541 9.7434 9.7419 9.7439 9.7492 9.7540 9.7560 9.7546 9.7559 9.7589 9.7661 9.7761 9.7872 9.7952 9.8021 9.8045 9.8014 9.7992 9.7952 9.7937 9.8014 9.8183 9.8372 9.8563 9.8693 9.8742 9.8780 9.8826 9.8924 9.9067 9.9284 9.9511 9.9737 9.9869 9.9941 9.9923 9.9869 9.9844 9.9891 10.0009 10.0178 10.0342 10.0422 10.0486 10.0429 10.0346 10.0298 10.0264 10.0325 10.0387 10.0458 10.0506 10.0545 10.0533 10.0504 10.0442 10.0441 10.0478 10.0589 10.0700 10.0759 10.0802 10.0787 10.0775 10.0760 10.0853 10.0963 10.1113 10.1252 10.1277 10.1247 10.1177 10.1091 10.0982 10.0952 10.0939 10.0985 10.1066 10.1091 10.1055 10.0984 10.0876 10.0768 10.0722 10.0681 10.0672 10.0678 10.0672 10.0611 10.0554 10.0446 10.0337 10.0232 10.0113 10.0029 9.9970 9.9874 9.9803 9.9755 9.9680 9.9649 9.9579 9.9450 9.9333 9.9178 9.9005 9.8828 9.8689 9.8559 9.8485 9.8301 9.8035 9.7732 9.7414 9.7055 9.6768 9.6585 9.6508 9.6488 9.6507 9.6571 9.6576 9.6592 9.6675 9.6727 9.6718 9.6731 9.6747 9.6755 9.6818 9.6889 9.6981 9.7060 9.7090 9.7020 9.6980 9.6958 9.6928 9.6888 9.6825 9.6756 9.6650 9.6531 9.6361 9.6232 9.6139 9.6059 9.6044 9.6048 9.6034 9.5911 9.5742 9.5552 9.5397 9.5355 9.5356 9.5385 9.5391 9.5342 9.5212 9.5089 9.4965 9.4851 9.4721 9.4688 9.4691 9.4673 9.4657 9.4531 9.4359 9.4255 9.4192 9.4118 9.4073 9.3957 9.3724 9.3521 9.3254 9.2948 9.2690 9.2366 9.2036 9.1836 9.1703 9.1568 9.1435 9.1205 9.0840 9.0464 9.0014 8.9481 8.8861 8.8141 8.7359 8.6570 8.5868 8.5207 8.4568 8.3976 8.3342 8.2670 8.1952 8.1205 8.0336 7.9458 7.8618 7.7789 7.7040 7.6372 7.5669 7.4977 7.4309 7.3666 7.3032 7.2516 7.2122 7.1808 7.1605 7.1471 7.1370 7.1361 7.1343 7.1432 7.1591 7.1792 7.1984 7.2229 7.2497 7.2738 7.3026 7.3290 7.3567 7.3844 7.4132 7.4493 7.4871 7.5303 7.5736 7.6137 7.6495 7.6907 7.7267 7.7687 7.8198 7.8648 7.9139 7.9638 8.0057 8.0448 8.0908 8.1328 8.1818 8.2347 8.2847 8.3336 8.3817 8.4311 8.4749 8.5188 8.5552 8.5872 8.6152 8.6431 8.6723 8.7014 8.7306 8.7642 8.7945 8.8217 8.8513 8.8757 8.8969 8.9197 8.9435 8.9753 9.0057 9.0369 9.0646 9.0890 9.1162 9.1417 9.1676 9.1909 9.2098 9.2210 9.2263 9.2296 9.2323 9.2363 9.2396 9.2404 9.2389 9.2337 9.2249 9.2140 9.2011 9.1910 9.1835 9.1801 9.1800 9.1772 9.1709 9.1595 9.1495 9.1475 9.1425 9.1449 9.1489 9.1449 9.1461 9.1513 9.1591 9.1677 9.1738 9.1803 9.1859 9.1894 9.1957 9.2002 9.2040 9.2072 9.2103 9.2108 9.2091 9.2070 9.2019 9.2034 9.2094 9.2167 9.2252 9.2310 9.2390 9.2483 9.2631 9.2780 9.2965 9.3147 9.3226 9.3288 9.3269 9.3197 9.3090 9.2987 9.2879 9.2798 9.2745 9.2670 9.2591 9.2517 9.2477 9.2372 9.2302 9.2278 9.2209 9.2236 9.2236 9.2237 9.2241 9.2238 9.2230 9.2230 9.2245 9.2287 9.2345 9.2440 9.2560 9.2652 9.2722 9.2794 9.2835 9.2862 9.2936 9.3035 9.3139 9.3279 9.3437 9.3613 9.3800 9.3956 9.4086 9.4219 9.4339 9.4544 9.4751 9.4938 9.5114 9.5269 9.5406 9.5526 9.5625 9.5733 9.5847 9.5944 9.6037 9.6105 9.6185 9.6299 9.6415 9.6524 9.6612 9.6719 9.6823 9.6908 9.6966 9.6992 9.6992 9.6991 9.6964 9.6889 9.6818 9.6734 9.6668 9.6634 9.6598 9.6547 9.6500 9.6368 9.6245 9.6118 9.5948 9.5808 9.5640 9.5461 9.5321 9.5165 9.5007 9.4819 9.4653 9.4454 9.4221 9.4034 9.3839 9.3679 9.3574 9.3465 9.3318 9.3166 9.2977 9.2806 9.2667 9.2524 9.2408 9.2312 9.2233 9.2151 9.2036 9.1934 9.1749 9.1630 9.1505 9.1369 9.1254 9.1140 9.0976 9.0845 9.0705 9.0602 9.0539 9.0491 9.0408 9.0352 9.0273 9.0156 9.0041 8.9946 8.9915 8.9981 9.0050 9.0055 8.9996 8.9896 8.9802 8.9860 9.0010 9.0211 9.0372 9.0436 9.0440 9.0463 9.0458 9.0500 9.0554 9.0599 9.0650 9.0764 9.0829 9.0859 9.0878 9.0951 9.1094 9.1342 9.1629 9.1840 9.2001 9.2125 9.2224 9.2360 9.2565 9.2826 9.3035 9.3164 9.3254 9.3310 9.3400 9.3512 9.3582 9.3623 9.3652 9.3636 9.5097 9.6742 9.6928 9.7100 9.7211 9.7305 9.7440 9.7556 9.7685 9.7847 9.7981 9.8118 9.8291 9.8520 9.8771 9.8974 9.9229 9.9542 9.9877 10.0163 10.0463 10.0770 10.1028 10.1277 10.1464 10.1667 10.1847 10.1987 10.2077 10.2233 10.2418 10.2619 10.2818 10.2971 10.3117 10.3220 10.3266 10.3363 10.3595 10.3847 10.4032 10.4238 10.4362 10.4541 10.4761 10.4939 10.5101 10.5311 10.5444 10.5661 10.5925 10.6249 10.6530 10.6802 10.7071 10.7307 10.7608 10.7811 10.7956 10.8069 10.8202 10.8294 10.8334 10.8341 10.8296 10.8290 10.8259 10.8250 10.8185 10.8163 10.8131 10.8069 10.8023 10.7982 10.8005 10.8012 10.8016 10.8051 10.8101 10.8194 10.8361 10.8548 10.8757 10.9005 10.9189 10.9312 10.9445 10.9578 10.9818 11.0103 11.0432 11.0805 11.1076 11.1266 11.1479 11.1660 11.1867 11.2079 11.2191 11.2347 11.2493 11.2569 11.2581 11.2517 11.2453 11.2388 11.2319 11.2298 11.2305 11.2294 11.2303 11.2287 11.2310 11.2315 11.2291 11.2273 11.2299 11.2289 11.2314 11.2331 11.2384 11.2494 11.2615 11.2694 11.2718 11.2752 11.2790 11.2886 11.2995 11.3053 11.3098 11.3147 11.3186 11.3222 11.3324 11.3407 11.3509 11.3573 11.3565 11.3506 11.3467 11.3354 11.3226 11.3124 11.3033 11.2819 11.2532 11.2134 11.1767 11.1499 11.1325 11.1205 11.1049 11.0995 11.0877 11.0675 11.0536 11.0402 11.0271 11.0245 11.0167 11.0000 10.9868 10.9690 10.9497 10.9279 10.9093 10.8958 10.8817 10.8683 10.8540 10.8372 10.8239 10.8225 10.8253 10.8319 10.8406 10.8365 10.8272 10.8203 10.8084 10.8010 10.7952 10.7852 10.7758 10.7683 10.7550 10.7486 10.7528 10.7498 10.7565 10.7644 10.7798 10.8021 10.8255 10.8480 10.8746 10.8997 10.9334 10.9657 10.9876 11.0161 11.0442 11.0736 11.1027 11.1238 11.1382 11.1485 11.1500 11.1518 11.1529 11.1584 11.1624 11.1613 11.1601 11.1519 11.1371 11.1241 11.0989 11.0749 11.0459 11.0125 10.9821 10.9522 10.9265 10.9051 10.8830 10.8565 10.8301 10.7993 10.7593 10.7213 10.6883 10.6611 10.6384 10.6233 10.6149 10.6079 10.6068 10.6008 10.5960 10.6035 10.6066 10.6120 10.6115 10.6061 10.6069 10.6097 10.6123 10.6235 10.6261 10.6286 10.6288 10.6176 10.6147 10.6216 10.6243 10.6298 10.6255 10.6266 10.6218 10.6156 10.6139 10.6164 10.6157 10.6083 10.5981 10.5812 10.5675 10.5624 10.5627 10.5791 10.5883 10.5998 10.6094 10.6094 10.6089 10.6102 10.6078 10.6030 10.6068 10.6137 10.6257 10.6325 10.6455 10.6506 10.6586 10.6663 10.6727 10.6790 10.6885 10.7001 10.7168 10.7393 10.7563 10.7779 10.7962 10.8242 10.8572 10.8840 10.9056 10.9246 10.9395 10.9650 10.9835 10.9966 11.0155 11.0343 11.0478 11.0521 11.0500 11.0448 11.0434 11.0442 11.0434 11.0512 11.0596 11.0723 11.0822 11.0788 11.0710 11.0618 11.0466 11.0362 11.0164 11.0102 10.9985 10.9881 10.9849 10.9805 10.9705 10.9628 10.9541 10.9345 10.9184 10.9054 10.8894 10.8820 10.8622 10.8491 10.8337 10.8121 10.7934 10.7697 10.7455 10.7188 10.6996 10.6692 10.6475 10.6295 10.6190 10.6243 10.6308 10.6471 10.6631 10.6774 10.6772 10.6727 10.6656 10.6631 10.6725 10.6910 10.7143 10.7415 10.7624 10.7729 10.7772 10.7784 10.7935 10.8226 10.8484 10.8695 10.8848 10.8943 10.9089 10.9221 10.9308 10.9345 10.9365 10.9537 10.9588 10.9697 10.9806 10.9906 10.9975 11.0131 11.0252 11.0338 11.0454 11.0526 11.0611 11.0714 11.0811 11.0963 11.1111 11.1240 11.1362 11.1422 11.1477 11.1491 11.2638 11.3831 11.3898 11.3991 11.4087 11.4294 11.4432 11.4533 11.4608 11.4724 11.4817 11.4863 11.4929 11.4891 11.4913 11.5003 11.5109 11.5158 11.5262 11.5258 11.5138 11.5027 11.4906 11.4759 11.4680 11.4605 11.4500 11.4337 11.4229 11.4081 11.3948 11.3714 11.3477 11.3223 11.2872 11.2506 11.2037 11.1485 11.1029 11.0578 11.0338 11.0176 11.0091 11.0134 11.0196 11.0284 11.0311 11.0272 11.0137 11.0074 11.0013 11.0128 11.0364 11.0684 11.0946 11.1136 11.1303 11.1396 11.1435 11.1422 11.1372 11.1402 11.1522 11.1654 11.1820 11.2036 11.2248 11.2585 11.2856 11.3048 11.3253 11.3339 11.3427 11.3413 11.3265 11.3128 11.3079 11.3090 11.3149 11.3140 11.3060 11.3114 11.3160 11.3266 11.3303 11.3299 11.3358 11.3416 11.3387 11.3302 11.3265 11.3199 11.3242 11.3350 11.3487 11.3630 11.3821 11.4124 11.4195 11.4213 11.4197 11.4066 11.3989 11.4027 11.4054 11.4116 11.4227 11.4194 11.4184 11.4252 11.4396 11.4502 11.4516 11.4563 11.4583 11.4699 11.4659 11.4599 11.4580 11.4493 11.4387 11.4412 11.4302 11.4349 11.4432 11.4324 11.4116 11.3838 11.3398 11.3021 11.2625 11.2195 11.1803 11.1346 11.1019 11.0773 11.0697 11.0740 11.0718 11.0690 11.0728 11.0653 11.0417 11.0240 10.9997 10.9930 10.9935 10.9909 10.9916 11.0036 11.0195 11.0256 11.0220 11.0300 11.0405 11.0570 11.0728 11.0785 11.0905 11.1064 11.1168 11.1177 11.1217 11.1276 11.1330 11.1241 11.1125 11.0984 11.0977 11.0947 11.0915 11.0904 11.0916 11.0964 11.0790 11.0557 11.0409 11.0196 11.0143 11.0006 10.9796 10.9614 10.9357 10.8933 10.8481 10.8141 10.7782 10.7674 10.7555 10.7499 10.7516 10.7446 10.7433 10.7419 10.7402 10.7415 10.7342 10.7402 10.7435 10.7478 10.7504 10.7526 10.7311 10.7326 10.7237 10.7176 10.7249 10.7400 10.7634 10.7831 10.8070 10.8429 10.8654 10.8980 10.9144 10.9323 10.9608 10.9869 11.0148 11.0589 11.0970 11.1378 11.1727 11.2004 11.2198 11.2585 11.2988 11.3240 11.3437 11.3615 11.3544 11.3525 11.3497 11.3373 11.3360 11.3467 11.3585 11.3628 11.3698 11.3660 11.3581 11.3584 11.3614 11.3495 11.3143 11.2887 11.2488 11.2128 11.1723 11.1459 11.1280 11.1192 11.1231 11.0983 11.0761 11.0571 11.0295 11.0053 10.9895 10.9695 10.9542 10.9227 10.8927 10.8715 10.8676 10.8634 10.8728 10.8800 10.8859 10.9154 10.9281 10.9305 10.9462 10.9542 10.9503 10.9568 10.9675 10.9834 11.0315 11.0527 11.0872 11.1291 11.1543 11.1796 11.2131 11.2144 11.2075 11.2156 11.2205 11.2137 11.2156 11.2208 11.2319 11.2461 11.2705 11.3043 11.3435 11.3746 11.4285 11.4511 11.4397 11.4373 11.4371 11.4195 11.4171 11.4242 11.4510 11.4921 11.5229 11.5469 11.5704 11.5973 11.5947 11.5969 11.5894 11.5740 11.5799 11.5671 11.5366 11.5344 11.5239 11.5045 11.4820 11.4604 11.4499 11.4539 11.4554 11.4366 11.4224 11.4060 11.3926 11.3350 11.2945 11.2572 11.2529 11.2298 11.2083 11.1985 11.1728 11.1689 11.1564 11.1457 11.1513 11.1528 11.1493 11.1414 11.1566 11.1320 11.1374 11.1141 11.1051 11.0985 11.0802 11.0666 11.0507 11.0541 11.0506 11.0703 11.0571 11.0995 11.1657 11.1829 11.1674 11.1105 11.0605 11.0361 11.0554 11.0830 11.1500 11.2356 11.3000 11.3201 11.2705 11.2457 11.2372 11.2013 11.2076 11.2348 11.2335 11.2523 11.2330 11.2243 11.2165 11.2196 11.2178 11.2248 11.2455 11.2591 11.2408 11.2135 11.1714 11.1130 11.0758 11.0305 11.0448 11.0621 11.0589 11.0578 11.0401 11.0106 10.8582 10.7353 10.7210 10.7358 10.7289 10.6828 10.6377 10.6359 10.5964 10.6453 10.6730 10.7090 10.7158 10.7287 10.7222 10.7631 10.8078 10.8498 10.8935 10.9671 10.9736 11.0099 11.0442 11.0385 11.0327 11.0129 10.9842 10.9396 10.9105 10.9184 10.9263 10.9837 11.0156 11.0293 11.0148 11.0067 10.9781 10.9505 10.9516 11.0075 11.0166 11.0999 11.0967 11.0800 11.0351 10.9853 10.9134 10.8602 10.7723 10.7340 10.6946 10.6819 10.6816 10.6805 10.6873 10.7199 10.7661 10.7886 10.8194 10.8340 10.8427 10.8429 10.8476 10.8715 10.9041 10.9615 11.0124 11.0742 11.0928 11.0765 11.0672 11.0505 11.0659 11.0893 11.1051 11.1276 11.1628 11.1876 11.1745 11.1509 11.1738 11.2104 11.2665 11.3205 11.3733 11.4323 11.4791 11.5157 11.5051 11.5077 11.5273 11.5252 11.5687 11.5999 11.5822 11.5900 11.5588 11.4599 11.3662 11.2768 11.1502 11.0592 11.0261 11.0054 11.0029 11.0090 10.9518 10.9492 10.8998 10.8683 10.8430 10.8237 10.8228 10.8172 10.8346 10.8765 10.8953 10.9128 10.9229 10.9498 10.9998 11.0238 11.0637 11.1126 11.1332 11.1318 11.1237 11.1552 11.1707 11.2145 11.2055 11.1954 11.1659 11.1151 11.0941 11.0911 11.0248 11.0419 11.0467 11.0502 11.1033 11.0991 11.1120 11.1396 11.1001 11.1036 11.1501 11.2283 11.3011 11.3570 11.3888 11.4214 11.4679 11.4624 11.4850 11.4992 11.5106 11.5922 11.6163 11.6521 11.7213 11.7359 11.6956 11.6777 11.6027 11.5280 11.4789 11.4269 11.4346 11.4643 11.4742 11.5064 11.5589 11.5428 11.5528 11.5103 11.4565 11.4092 11.4055 11.3467 11.3442 11.3501 11.3393 11.4179 11.4841 11.5129 11.5237 11.5209 11.4556 11.4296 11.4512 11.4517 11.5076 11.5478 11.4906 11.5003 11.5217 11.5687 11.6057 11.6347 11.6730 11.6816 11.7392 11.7945 11.8113 11.7919 11.8415 11.8774 11.8999 11.9788 11.9914 12.0106 11.9980 11.9743 11.9110 11.8952 11.8902 11.8473 11.8152 11.7529 11.7283 11.7126 11.7306 11.8037 11.8152 11.8148 11.8665 11.8602 11.8685 11.9502 11.9959 12.0126 12.0876 12.1104 12.0860 12.1645 12.1678 12.1416 12.1007 12.0408 11.9953 11.9216 11.8799 11.8447 11.7231 11.6417 11.6211 11.6146 11.5830 11.6087 11.6078 11.6514 11.6695 11.6573 11.6430 11.6231 11.6197 11.6639 11.6843 11.7636 11.8151 11.8288 11.7761 11.7053 11.6237 11.5271 11.4307 11.4450 11.4312 11.4815 11.5418 11.6575 11.7924 11.8702 12.0338 12.0696 12.0567 12.1022 12.0115 11.9210 11.9321 11.8594 11.8522 11.8455 11.8811 11.8744 11.9408 11.9347 11.9498 12.0271 12.0449 12.0143 12.0737 12.0139 11.9733 12.0166 11.9299 11.9284 12.0342 12.0742 12.1124 12.0656 11.9611 11.7622 11.5864 11.4994 11.4479 11.4717 11.5634 11.6227 11.5210 11.4730 11.3545 11.2318 11.1793 11.0296 10.9809 11.1008 11.2256 11.4685 11.6035 11.6206 11.5725 11.5132 11.4093 11.3611 11.3105 11.2715 11.2388 11.2311 11.1527 11.1377 11.1424 11.1229 11.1920 11.2839 11.1525 11.1272 11.1117 11.0199 11.1392 11.2322 11.2593 11.4440 11.4972 11.4601 11.5365 11.5180 11.5093 11.5855 11.5774 11.4847 11.4682 11.4561 11.5002 11.5617 11.4983 11.3902 11.4010 11.4065 11.4137 11.4644 11.4895 11.5300 11.6384 11.7161 11.7149 11.7214 11.7455 11.7276 11.7456 11.8478 11.9260 12.0165 11.9991 11.8823 11.8941 11.9409 11.9688 12.0141 11.9905 11.8781 11.9323 11.9075 11.9797 12.2398 12.4149 12.4771 12.5504 12.4317 12.2841 12.2220 12.1594 12.1138 12.1212 12.2331 12.2709 12.3545 12.3836 12.4301 12.3769];

    otherwise
        disp('WRONG TYPE OF HORN');
        quit;
end

% interpolate gain of horn at measured frequencies
gain_horn_f = interp1(freq_horn,gain_horn,freq);

% speed of light [m/s]
c = 2.99792458*10^8;

% wavelength [m]
lambda = c./(freq*10^9);

% path loss [dB]
PL = 20*log10((4*pi*d)./lambda);

% antenna mismatch at polarisation 0 [dB] 
Mr_dB = 10*log10(1-(abs(S22_pol_0)).^2);

% horn mismatch at polarisation 0 [dB]
Mt_dB = 10*log10(1-(abs(S11_pol_0)).^2); 

% correction from friis formula [dB]
corr_dB = - Mr_dB - Mt_dB + PL - gain_horn_f;

% corrected gain
gain_pol_0_dB = 20*log10(abs(S21_pol_0)) + corr_dB;
gain_pol_90_dB = 20*log10(abs(S21_pol_90)) + corr_dB;

gain_pol_0_lin = 10.^(gain_pol_0_dB/10);
gain_pol_90_lin = 10.^(gain_pol_90_dB/10);

% total gain is sum of both
gain_tot = gain_pol_0_lin + gain_pol_90_lin;

% gain [dB]
gain_tot_dB = 10.*log10(abs(gain_tot));


% plot gain
if plots~=0
figure;
plot(freq,gain_tot_dB);
set(gca,'GridLineStyle',':');
set(gca,'XGrid','on');
set(gca,'YGrid','on');
xlabel('Frequency [GHz]');
ylabel('Gain [dBi]');
title('Gain in broadside direction');
end


% calculate axial ratio
E_lhp = (1/sqrt(2))*(S21_pol_0-1j*S21_pol_90);
E_lhp_ampl = 20*log10(abs(E_lhp));

E_rhp = (1/sqrt(2))*(S21_pol_0+1j*S21_pol_90);
E_rhp_ampl = 20*log10(abs(E_rhp));

AR = (abs(E_lhp)+abs(E_rhp))./(abs(E_lhp)-abs(E_rhp));
AR_dB = 20.*log10(abs(AR));

%% Stuff for circularly polarised radiation patterns
% Calculate the left and right E fields
E_left_real = 0.5*(real(S21_pol_0)+imag(S21_pol_90));
E_left_imag = 0.5*(imag(S21_pol_0)-real(S21_pol_90));
E_right_real = 0.5*(real(S21_pol_0)-imag(S21_pol_90));
E_right_imag = 0.5*(imag(S21_pol_0)+real(S21_pol_90));

% Get the amplitude ratio of the two
mag_E_left = sqrt(abs(E_left_real).^2+abs(E_left_imag).^2);
mag_E_right = sqrt(abs(E_right_real).^2+abs(E_right_imag).^2);
pol_ratio_c = (mag_E_right./mag_E_left).^2;

% The gains have the same ratio as the amplitudes
gain_right = pol_ratio_c.*10.^(gain_tot_dB./10)./(1+pol_ratio_c);
gain_left = 10.^(gain_tot_dB./10)-gain_right;
% AR = (abs(mag_E_left)+abs(mag_E_right))./(abs(mag_E_left)-abs(mag_E_right));
% results.axial_ratio = 20.*log10(abs(AR));
% 
% % %Freek
% % E_lhp = (1/sqrt(2))*(S21_0pol-j*S21_90pol);
% % E_lhp_ampl = 20*log10(abs(E_lhp));
% % 
% % E_rhp = (1/sqrt(2))*(S21_0pol+j*S21_90pol);
% % E_rhp_ampl = 20*log10(abs(E_rhp));
% % 
% % AR_F = (abs(E_lhp)+abs(E_rhp))./(abs(E_lhp)-abs(E_rhp));
% % AR_F_dB = 20.*log10(abs(AR));
% % results.axial_ratio_F=AR_F_dB;
% % % Convert to dB
gain_right = 10*log10(gain_right);
gain_left = 10*log10(gain_left);

% plot axial ratio
if plots~=0
figure;
plot(freq,AR_dB);
set(gca,'GridLineStyle',':');
set(gca,'XGrid','on');
set(gca,'YGrid','on');
xlabel('Frequency [GHz]');
ylabel('AR [dB]');
title('Axial ratio in broadside direction');
end

result.freq=freq;
result.gain_tot_dB=gain_tot_dB;
result.AR_dB=AR_dB;
result.S22_pol_0=20*log10(abs(S22_pol_0));
result.gain_right=gain_right;
result.gain_left=gain_left;
result.E_left=E_left_real+1j*E_left_imag;
result.E_right=E_right_real+1j*E_right_imag;

end

